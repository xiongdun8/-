## 八卦六爻排盘程序


 一个基于python的六爻排盘程序，根据用户的输入自动分析本卦与变卦（包含衰旺分析），自动计算当前时间的旬空，自动查找匹配的卦名、卦辞、爻辞，可直接接入deepseek API分析

> 六爻八卦预测，是古人观察大自然运行规律总结出来的一项法则。起源于西汉京房的纳甲体系。起初是用50根蓍草，到宋朝时才有了“以钱代蓍”。预测人将三枚铜钱放于手中，双手紧扣，思其所测之事，让所测信息融贯于铜钱之中，合掌摇晃后放入卦盘中，掷六次而成卦。
> 卦成后，配以卦爻，及动变以后。通过测卦当日的干支，配以六亲（“我”，父母，兄弟，妻财，官鬼，子孙）及六兽（青龙，白虎，朱雀，玄武，勾陈（麒麟）和腾蛇），主要依靠用神的五行生旺，结合易经的爻辞，而判断事物的发展过程和结果。六爻是民间流传最广的预测方法之一

程序运行打印结果（示例）


```
六爻排盘程序（含纳甲、六兽、六亲、旺衰）
请输入起卦原因：
求财运

卦象编码：1=少阴，2=少阳，3=纯阳（动爻），4=纯阴（动爻）
请输入6爻（从初爻到上爻，用空格分隔）：
输入6个数字（1-4）：1 2 3 4 4 3

当前时间：2025年9月6日 16:34
是否使用当前时间？(y/n)：y

============================================================================================================================================
排盘时间：2025年9月6日 16:34
起卦原因：求财运
地支：年巳 月午 日辰 时申
旬空：戌亥空
本卦：巽宫归魂卦（山风蛊）  世爻：三爻(酉)  应爻：上爻(卯)
变卦：兑宫一世卦（泽水困）  世爻：初爻(巳)
============================================================================================================================================

【本卦】
六兽       六亲        爻位      世应（+为世）卦象         地支(五行)          类型           旺衰得分            状态
--------------------------------------------------------------------------------------------------------------------------------------------
螣蛇       妻财       上爻        *        -----  →       卯(木)            纯阳           旺衰得分：-1.5   状态：休囚（休）、入变爻墓
勾陈       官鬼       五爻       ---       -- --  →       巳(火)            纯阴           旺衰得分：1.0    状态：月扶
朱雀       父母       四爻       ---       -- --  →       未(土)            纯阴           旺衰得分：-1.1   状态：合旺、月生、日扶、帝旺、入日墓、化绝
青龙       兄弟       三爻        +        -----  →       酉(金)            纯阳           旺衰得分：0.5    状态：合绊、日生、月克、休囚（死）、入变爻墓
玄武       子孙       二爻       ---       -----          亥(水)            少阳           旺衰得分：-0.1   状态：日克、休囚（囚）、入日墓
白虎       父母       初爻       ---       -- --          丑(土)            少阴           旺衰得分：-0.1   状态：月生、日扶、帝旺、入日墓、入四爻墓

【变卦】
六兽       六亲        爻位      世应（+为世）卦象         地支(五行)          类型           旺衰得分            状态
--------------------------------------------------------------------------------------------------------------------------------------------
螣蛇       子孙       上爻       ---       -- --          未(土)            少阴           旺衰得分：-0.1   状态：合旺、月生、日扶、帝旺、入日墓
勾陈       妻财       五爻       ---       -----          酉(金)            少阳           旺衰得分：0.5    状态：合绊、日生、月克、休囚（死）
朱雀       官鬼       四爻        *        -----          亥(水)            少阳           旺衰得分：-0.1   状态：日克、休囚（囚）、入日墓
青龙       子孙       三爻       ---       -- --          丑(土)            少阴           旺衰得分：-0.1   状态：月生、日扶、帝旺、入日墓、回头生
玄武       父母       二爻       ---       -----          卯(木)            少阳           旺衰得分：-1.5   状态：休囚（休）
白虎       兄弟       初爻        +        -- --          巳(火)            少阴           旺衰得分：1.0    状态：月扶

动爻汇总：3, 4, 5, 6爻

============================================================================================================================================

本卦卦名：山风蛊
卦辞：元亨，利涉大川。先甲三日，后甲三日。
初六：干父之蛊，有子，考无咎，厉终吉。
九二：干母之蛊，不可贞。
九三：干父之蛊，小有悔，无大咎。
六四：裕父之蛊，往见吝。
六五：干父之蛊，用誉。
上九：不事王侯，高尚其事。

============================================================================================================================================

地支相合：子丑合土局（水）; 寅亥合木局;卯戌合火局; 辰酉合金局; 巳申合水局; 午未合土局
地支相冲：子午；丑未；寅申；卯酉；辰戌；巳亥
木长生在亥，旺在卯，墓在未，绝于申；
金长生在巳，旺在酉，墓在丑，绝于寅；
火长生在寅，旺在午，墓在戌，绝于亥；
水长生在申，旺在子，墓在辰，绝于巳；
土随火行：长生在寅，绝于亥；墓于四墓库，旺于四墓库

    季节	旺  相  休  囚  死
    春季    木  火  水  金  土
    夏季    火  土  木  水  金
    秋季    金  水  土  火  木
    冬季    水  木  金  土  火
    季末    土  金  火  木  水 

旺衰得分仅作最基础参考

是否使用AI解析排盘结果？(y/n)：n

程序结束，未使用AI解析功能。
```
移动端图像化界面

![https://github.com/xiongdun8/liuyao/blob/main/github_image/BaiduShurufa_2025-9-6_21-2-15.png]()

![https://github.com/xiongdun8/liuyao/blob/main/github_image/BaiduShurufa_2025-9-6_21-2-45.png]()

复制仓库到本地\直接打包下载


```
git clone https://github.com/xiongdun8/liuyao.git
```
如果下载速度过慢，可使用国内网盘
[https://wwgm.lanzouu.com/iiS8C35kg3mf]()

如果想要运行图像化界面（UImain.py），需要安装kivy库：

```
python -m pip install docutils pygments pypiwin32 kivy.deps.sdl2 kivy.deps.glew
python -m pip install kivy.deps.gstreamer  #  pip 安装 kivy 依赖（window环境下）
python -m pip install kivy  #  安装kivy
python -m pip install kivy_examples  #  安装 kivy 官方示例
```


**如何使用**

如果你需要测试，直接运行main.py，或者

```
python main.py
```
如果你需要运行图像化程序，直接运行UImain.py，或者

```
python UImain.py
```
**如何调用**

主程序main.py中的arrange_hexagram(original_hexagram, time, reason)函数为关键函数，方法调用如下：

**1. 第一个参数：original_hexagram（本卦编码列表）**

参数类型：list（整数列表）
核心作用：存储 “从初爻到上爻” 的 6 条爻的编码，代表本卦的原始卦象（静爻 / 动爻）。

格式要求：
列表长度必须为 6（对应初爻→二爻→三爻→四爻→五爻→上爻，顺序不可颠倒）。
列表元素仅允许为 1、2、3、4 四个整数，含义固定：

1：少阴（静爻，符号 -- --）

2：少阳（静爻，符号 -----）

3：纯阳（动爻，符号 ----- →，变卦中转为少阴 -- --）

4：纯阴（动爻，符号 -- -- →，变卦中转为少阳 -----）

示例：
若本卦为 “初爻少阳、二爻少阴、三爻纯阳（动）、四爻纯阴（动）、五爻少阳、上爻少阴”，则参数为：


```
original_hexagram = [2, 1, 3, 4, 2, 1]
```

**2. 第二个参数：time（起卦时间对象）**

参数类型：datetime.datetime（Python 标准库的 datetime 对象）

核心作用：提供起卦的年、月、日、时，用于计算地支、旬空、六兽顺序等关键信息。

格式要求：
 

```
datetime.datetime(year, month, day, hour, minute)   #  必须通过此方法构造（需导入 datetime 模块）。
```

参数均为 整数，且符合真实日期时间规则（如月份 1-12，日期 1-31，小时 0-23，分钟 0-59）。

无需传入秒或微秒（函数内部不使用）。

示例：
若起卦时间为 “2024 年 5 月 20 日 15 时 30 分”，则参数构造为：


```
python import datetime time = datetime.datetime(2024, 5, 20, 15, 30)
```


**3. 第三个参数：reason（起卦原因）**

参数类型：str（字符串）

核心作用：描述起卦的目的（如问事业、感情、健康等），仅用于排盘结果的文字说明，不影响计算逻辑。

格式要求：
非空字符串（如需使用AI功能，需要避免无意义内容）。
无固定长度限制，支持中文、英文等字符。
示例：


```
reason = "占问与朋友的债务纠纷能否顺利解决"
```
**关于AI**

AI部分直接调用相关API接口实现，目前基于Deepseek文档进行开发。其他主流AI或许请求方法类似，如果需要调用其他AI，尝试修改ai_main.py大约在第31行的请求URL，并修改请求头

```
url = "https://api.deepseek.com/chat/completions"
```

如果需要接入，还需修改相关文件（main.py或UImain.py）的APIkey变量，以实现正确调用

如果你需要修改/根据自身情况调整，ai_main.py中deepseek_chat（）的函参对应如下：

```
    参数:
        api_key: DeepSeek API密钥
        prompt: 当前提问内容
        stream: 是否启用流式输出（默认True）
        max_tokens: 最大输出token数（默认1024）
        temperature: 生成随机性（0-1，默认0.7）
        history: 对话历史，格式为[{"role": "user/assistant", "content": "..."}]
        model: 模型名称（默认deepseek-reasoner，可选deepseek-chat）
```

对了，ai_text变量存储了向ai提问的必要文本（即省略了相关备忘信息和分割线的阉割排盘信息，以便节省tokens）

**特别注意**

字体文件为更纱黑体（等距简体字体）：该字体可能需要商用许可，你可能需要授权才能进行商用

64卦详解网站，对应图像化界面的主页的查询按键，可自行修改：

```
webbrowser.open('http://zy.kvov.com/index.php')  #  在UImain.py约第239行
```
